<!DOCTYPE html>
<html lang="en">
<head>
  <title>Oo3d Basic Usage</title>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <script src="../build/oo3d.js"></script>
  <script>
    addEventListener('load', function () {
      try {
        var
          $ = document.querySelector.bind(document)
         ,$error = $('#error')

         ,$target = $('#target')

         ,$rotateXMinus = $('#rotateXMinus')
         ,$rotateYMinus = $('#rotateYMinus')
         ,$rotateZMinus = $('#rotateZMinus')
         ,$rotateXLabel = $('#rotateXLabel')
         ,$rotateYLabel = $('#rotateYLabel')
         ,$rotateZLabel = $('#rotateZLabel')
         ,$rotateXPlus  = $('#rotateXPlus')
         ,$rotateYPlus  = $('#rotateYPlus')
         ,$rotateZPlus  = $('#rotateZPlus')

         ,$translateXMinus = $('#translateXMinus')
         ,$translateYMinus = $('#translateYMinus')
         ,$translateZMinus = $('#translateZMinus')
         ,$translateXLabel = $('#translateXLabel')
         ,$translateYLabel = $('#translateYLabel')
         ,$translateZLabel = $('#translateZLabel')
         ,$translateXPlus  = $('#translateXPlus')
         ,$translateYPlus  = $('#translateYPlus')
         ,$translateZPlus  = $('#translateZPlus')

         ,updateMeasurements = function () {
            target = $target.value ? oo3d.buffers[+$target.value] : oo3d.camera;
            $rotateXLabel.innerHTML = target.rotateX;
            $rotateYLabel.innerHTML = target.rotateY;
            $rotateZLabel.innerHTML = target.rotateZ;
            $translateXLabel.innerHTML = target.translateX;
            $translateYLabel.innerHTML = target.translateY;
            $translateZLabel.innerHTML = target.translateZ;
          }

         ,oo3d = new Oo3d({
            $main: document.getElementById('main')
          })
         ,tri0 = oo3d.addBuffer({
            positions: [
               0.0,  0.3,  1.0,
              -0.4, -0.5,  1.0,
               0.8, -0.3,  1.0
            ]
           ,colors: [
               1.0,  0.0,  0.0,  1.0, // red
               0.0,  1.0,  0.0,  1.0, // green
               0.0,  0.0,  1.0,  1.0  // blue
            ]
           // ,transforms: [
           //    {
           //      type: 'translate'
           //     ,x:0.2, y:-0.3, z:-0.3
           //    }
           //   ,{
           //      type: 'rotate'
           //     ,rad:0.2
           //    }
           //  ]
          })
         ,tri1 = oo3d.addBuffer({
            positions: [
               1.0, -0.3,   0.0,
               0.4,  0.5,  -1.0,
               0.2,  0.3,  -1.0
            ]
           ,colors: [
               1.0,  1.0,  0.0,  1.0, // yellow
               0.0,  1.0,  1.0,  1.0, // cyan
               1.0,  0.0,  1.0,  1.0  // magenta
            ]
          })
         ,pyramid0 = oo3d.addBuffer({
            positions: [
              // Front face
               0.0,  1.0,  0.0,
              -1.0, -1.0,  1.0,
               1.0, -1.0,  1.0,
              // Right face
               0.0,  1.0,  0.0,
               1.0, -1.0,  1.0,
               1.0, -1.0, -1.0,
              // Back face
               0.0,  1.0,  0.0,
               1.0, -1.0, -1.0,
              -1.0, -1.0, -1.0,
              // Left face
               0.0,  1.0,  0.0,
              -1.0, -1.0, -1.0,
              -1.0, -1.0,  1.0
            ]
           ,colors: [
              // Front face
               1.0,  0.25,  0.0,  0.15, // translucent orange
               1.0,  0.25,  0.0,  0.15, // translucent orange
               1.0,  0.25,  0.0,  0.15, // translucent orange
              // Right face
               0.0,  0.25,  0.0,  0.75, // translucent lime
               0.0,  0.25,  0.0,  0.75, // translucent lime
               0.0,  0.25,  0.0,  0.75, // translucent lime
              // Back face
               1.0,   0.5,  1.0,  0.95, // translucent pink
               1.0,   0.5,  1.0,  0.95, // translucent pink
               1.0,   0.5,  1.0,  0.95, // translucent pink
              // Left face
               0.25,  0.5,  1.0,  0.75, // translucent light cyan
               0.25,  0.5,  1.0,  0.75, // translucent light cyan
               0.25,  0.5,  1.0,  0.75  // translucent light cyan
            ]
          })
        ;
        updateMeasurements();
        $target.onchange = updateMeasurements;


        // oo3d.transform({ // no target, so transform the camera
        //   type: 'translate'
        //  ,x:    0
        //  ,y:    0
        //  ,z:    10
        // });
        // oo3d.transform({
        //   target: pyramid0
        //  ,type: 'rotateY'
        //  ,rad:  0.1
        // });
        // oo3d.transform({
        //   target: pyramid0
        //  ,type: 'translate'
        //  ,x:    20
        //  ,y:    100
        //  ,z:    30
        // });
        oo3d.render();
        // console.log('indexes: ', tri0, tri1, pyramid0);


        // ROTATE X
        $rotateXLabel.curr = 0;
        $rotateXMinus.onclick = function () {
          $rotateXLabel.curr -= 0.098174770424681;
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'rotateX'
           ,rad:  -0.098174770424681
          });
          oo3d.render();
          updateMeasurements();
        }
        $rotateXPlus.onclick = function () {
          $rotateXLabel.curr += 0.098174770424681;
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'rotateX'
           ,rad:  0.098174770424681
          });
          oo3d.render();
          updateMeasurements();
        }


        // ROTATE Y
        $rotateYLabel.curr = 0;
        $rotateYMinus.onclick = function () {
          $rotateYLabel.curr -= 0.098174770424681;
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'rotateY'
           ,rad:  -0.098174770424681
          });
          oo3d.render();
          updateMeasurements();
        }
        $rotateYPlus.onclick = function () {
          $rotateYLabel.curr += 0.098174770424681;
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'rotateY'
           ,rad:  0.098174770424681
          });
          oo3d.render();
          updateMeasurements();
        }


        // ROTATE Z
        $rotateZLabel.curr = 0;
        $rotateZMinus.onclick = function () {
          $rotateZLabel.curr -= 0.098174770424681;
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'rotateZ'
           ,rad:  -0.098174770424681
          });
          oo3d.render();
          updateMeasurements();
        }
        $rotateZPlus.onclick = function () {
          $rotateZLabel.curr += 0.098174770424681;
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'rotateZ'
           ,rad:  0.098174770424681
          });
          oo3d.render();
          updateMeasurements();
        }


        // TRANSLATE X
        $translateXLabel.curr = 0;
        $translateXMinus.onclick = function () {
          $translateXLabel.curr -= 1
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'translate'
           ,x:  -1
          });
          oo3d.render();
          updateMeasurements();
        }
        $translateXPlus.onclick = function () {
          $translateXLabel.curr += 1
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'translate'
           ,x:  1
          });
          oo3d.render();
          updateMeasurements();
        }


        // TRANSLATE Y
        $translateYLabel.curr = 0;
        $translateYMinus.onclick = function () {
          $translateYLabel.curr -= 1
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'translate'
           ,y:  -1
          });
          oo3d.render();
          updateMeasurements();
        }
        $translateYPlus.onclick = function () {
          $translateYLabel.curr += 1
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'translate'
           ,y:  1
          });
          oo3d.render();
          updateMeasurements();
        }


        // TRANSLATE Z
        $translateZLabel.curr = -5;
        $translateZMinus.onclick = function () {
          $translateZLabel.curr -= 1
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'translate'
           ,z:  -1
          });
          oo3d.render();
          updateMeasurements();
        }
        $translateZPlus.onclick = function () {
          $translateZLabel.curr += 1
          oo3d.transform({
            target: $target.value ? +$target.value : undefined
           ,type: 'translate'
           ,z:  1
          });
          oo3d.render();
          updateMeasurements();
        }

      } catch (error) {
        $error.innerHTML = error;
        $error.className = ''; // remove '.hidden'
      }
    });
  </script>
  <style>
    html, body {
      margin: 0;
    }
    #main {
      position: absolute;
      top:     0;
      left:    0;
      width:   100%;
      height:  100%;
      z-index: 5;
    }
    select, label, input {
      position: relative;
      z-index: 10;
    }
    #error {
      position: absolute;
      box-sizing: border-box;
      bottom:  0;
      left:    5%;
      width:  90%;
      padding: 1rem;
      font-family: monaco, monospace;
      background-color: #933;
      color: #fff;
      transition: all 0.5s;
      opacity: 1;
    }
    #error.hidden {
      padding-bottom: 0;
      opacity: 0;
    }
  </style>
</head>
<body>
  <h1>Oo3d Basic Usage</h1>
  <a href="../index.html">Home</a>
  <canvas id="main"></canvas>
  <br>
  <select id="target">
    <option value="">Camera</option>
    <option value="0">RGB Triangle</option>
    <option value="1">CMY Triangle</option>
    <option value="2">Pyramid</option>
  </select>
  <br>
  <input type="button" id="rotateXMinus" value="Rotate X Minus">
  <input type="button" id="rotateXPlus"  value="Rotate X Plus">
  <label id="rotateXLabel">...</label>
  <br>
  <input type="button" id="rotateYMinus" value="Rotate Y Minus">
  <input type="button" id="rotateYPlus"  value="Rotate Y Plus">
  <label id="rotateYLabel">...</label>
  <br>
  <input type="button" id="rotateZMinus" value="Rotate Z Minus">
  <input type="button" id="rotateZPlus"  value="Rotate Z Plus">
  <label id="rotateZLabel">...</label>
  <br>
  <input type="button" id="translateXMinus" value="Translate X Minus">
  <input type="button" id="translateXPlus"  value="Translate X Plus">
  <label id="translateXLabel">...</label>
  <br>
  <input type="button" id="translateYMinus" value="Translate Y Minus">
  <input type="button" id="translateYPlus"  value="Translate Y Plus">
  <label id="translateYLabel">...</label>
  <br>
  <input type="button" id="translateZMinus" value="Translate Z Minus">
  <input type="button" id="translateZPlus"  value="Translate Z Plus">
  <label id="translateZLabel">...</label>
  <br>
  <div id="error" class="hidden"></div>
</body>
</html>
